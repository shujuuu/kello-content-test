       copy dslang.cpy.
       IDENTIFICATION DIVISION.
       PROGRAM-ID.    CRP9108.
       AUTHOR.        ALFREDO SAVIOLLI NETO.
      *GERA ARQUIVO REMESSA P/ BANCO DO BRASIL (EDA)
       DATE-WRITTEN.  18/06/05.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SPECIAL-NAMES. DECIMAL-POINT IS COMMA
                      PRINTER IS LPRINTER.
       class-control.
           Window             is class "wclass".
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           COPY CAPX010.
           COPY CAPX002.
           COPY CAPX018.
           COPY CRPX020.
           COPY CGPX010.
           COPY CGPX011.
           COPY CGPX014.
           COPY CRPX200.
           COPY CRPX201.
           COPY RETPORT.SEL.
           COPY LOGACESS.SEL.
           SELECT SEQBRAS ASSIGN TO PATH-SEQBRA
                  ORGANIZATION IS INDEXED
                  ACCESS MODE IS DYNAMIC
                  STATUS IS ST-SEQ
                  RECORD KEY IS CONT-SEQUENCIA.
           SELECT REMESSA ASSIGN TO REMESSA-NOME
                  ORGANIZATION IS LINE SEQUENTIAL
                  ACCESS MODE IS SEQUENTIAL.
           SELECT REMESSA2 ASSIGN TO REMESSA-NOME2
                  ORGANIZATION IS SEQUENTIAL
                  ACCESS MODE IS SEQUENTIAL.
           SELECT WORK ASSIGN TO VARIA-W
                  ORGANIZATION IS INDEXED
                  ACCESS MODE IS DYNAMIC
                  STATUS IS ST-WORK
                  RECORD KEY IS SEQ-WK
                  ALTERNATE RECORD KEY IS NOME-WK WITH DUPLICATES.
           SELECT RELAT ASSIGN TO PRINTER NOME-IMPRESSORA.

       DATA DIVISION.
       FILE SECTION.
       COPY CAPW002.
       COPY CAPW010.
       COPY CAPW018.
       COPY CRPW020.
       COPY CGPW010.
       COPY CGPW011.
       COPY CGPW014.
       COPY CRPW200.
       COPY CRPW201.
       COPY RETPORT.FD.
       COPY LOGACESS.FD.
       FD  SEQBRAS.
       01  REG-SEQBRAS.
           05  CONT-SEQUENCIA  PIC 9.
           05  SEQUENCIA       PIC 9(10).
       FD  REMESSA.
       01  REG-REMESSA.
           05  ID-REG-REM       PIC X(02).
           05  DADOS-REM        PIC X(498).
       FD  REMESSA2
           label record is omitted.
       01  REG-REMESSA2.
           05  ID-REG-REM2      PIC X(02).
           05  DADOS-REM2       PIC X(498).
           05  pula-rem2        pic x(02).

       FD  WORK.
       01  REG-WORK.
           05  SEQ-WK           PIC 9(3).
           05  NOME-WK          PIC X(35).
           05  ENDERECO-WK      PIC X(35).
           05  CEP-WK           PIC 9(8).
           05  CIDADE-WK        PIC X(15).
           05  UF-WK            PIC XX.
           05  DOCTO-WK         PIC X(10).
           05  VALOR-WK         PIC 9(8)V99.
       FD  RELAT
           LABEL RECORD IS OMITTED.
       01  REG-RELAT.
           05  FILLER          PIC X(132).
       WORKING-STORAGE SECTION.
           COPY IMPRESSORA.
           COPY "CRP9108.CPB".
           COPY "CRP9108.CPY".
           COPY "DS-CNTRL.MF".
           COPY "CBPRINT.CPY".
       78  REFRESH-TEXT-AND-DATA-PROC VALUE 255.
       77  DISPLAY-ERROR-NO          PIC 9(4).
       01  AREAS-DE-TRABALHO.
           05 ERRO-1              PIC XX     VALUE SPACES.
           05 ST-CAD002           PIC XX     VALUE SPACES.
           05 ST-CAD010           PIC XX     VALUE SPACES.
           05 ST-CAD018           PIC XX     VALUE SPACES.
           05 ST-CRD020           PIC XX     VALUE SPACES.
           05 ST-REM              PIC XX     VALUE SPACES.
           05 ST-CGD010           PIC XX     VALUE SPACES.
           05 ST-CGD011           PIC XX     VALUE SPACES.
           05 ST-CGD014           PIC XX     VALUE SPACES.
           05 ST-CRD200           PIC XX     VALUE SPACES.
           05 ST-CRD201           PIC XX     VALUE SPACES.
           05 FS-RETPORT          PIC XX     VALUE SPACES.
           05 FS-LOGACESS         PIC XX     VALUE SPACES.
           05 ST-SEQ              PIC XX     VALUE SPACES.
           05 ST-WORK             PIC XX     VALUE SPACES.
           05 VARIA-W             PIC 9(8)   VALUE ZEROS.
           05 VALOR-W             PIC 9(11)V99 VALUE ZEROS.
           05 TIPO-W              PIC 99     VALUE ZEROS.
           05 SEQ-W               PIC 9(6)   VALUE ZEROS.
           05 AUX-TIPO-DOCTO      PIC X(20)  VALUE SPACES.
           05 MENSAGEM            PIC X(200).
           05 TIPO-MSG            PIC X(01).
           05 RESP-MSG            PIC X(01).
           05 SENHA               PIC 9(04)  VALUE ZEROS.
           05 OPCAO               PIC 9      VALUE ZEROS.
           05 DATA-DIA            PIC 9(6)   VALUE ZEROS.
           05 DATA-DIA-I          PIC 9(8)   VALUE ZEROS.
           05 HORA-BRA            PIC 9(8)   VALUE ZEROS.
           05 ULT-SEQ             PIC 9(5)   VALUE ZEROS.
           05 DATA-E             PIC 99/99/99.
           05 REMESSA-NOME        PIC X(12)  VALUE SPACES.
           05 SEQUENCIA-W         PIC 9(10)     VALUE ZEROS.
           05 VALOR-ATRASO        PIC 9(11)V99 VALUE ZEROS.
           05 COD-COMPL-CR20-W    PIC 9(09)  VALUE ZEROS.
           05 CONF                PIC X      VALUE SPACES.
           05 VALOR-TOTAL         PIC 9(12)V99 VALUE ZEROS.
           05 QTDE-TIT            PIC 9(4)     VALUE ZEROS.
           05 ERRO-W              PIC 9        VALUE ZEROS.
           05 DATA-INV            PIC 9(8)     VALUE ZEROS.
           05 VENCTO-INI-INV      PIC 9(8)     VALUE ZEROS.
           05 VENCTO-FIM-INV      PIC 9(8)     VALUE ZEROS.
           05 MOVTO-INI-INV       PIC 9(8)     VALUE ZEROS.
           05 MOVTO-FIM-INV       PIC 9(8)     VALUE ZEROS.
           05 TAXA-JUROS          PIC 9(03)V99 VALUE ZEROS.
           05 LIN                 PIC 9(02)    VALUE ZEROS.
           05 IND                 PIC 9(02)    VALUE ZEROS.
           05 TOTAL               PIC 9(4)     VALUE ZEROS.
           05 VALOR               PIC 9(4)     VALUE ZEROS.
           05 RESTO               PIC 9(2)     VALUE ZEROS.
           05 AUX-TIPO            PIC 9(1)     VALUE ZEROS.
           05 DIGITO-VERIFICADOR  PIC X(1)     VALUE SPACES.
           05 DATAW.
              10  DIA-W       PIC 99.
              10  MES-W       PIC 99.
              10  ANO-W       PIC 99.
           05 DATA-W REDEFINES DATAW PIC 9(6).
           05 DATAI.
              10  ANO-I       PIC 99.
              10  MES-I       PIC 99.
              10  DIA-I       PIC 99.
           05 DATA-I REDEFINES DATAI PIC 9(6).
           05 REM-TIPO0.
              10  TIPO-INSC-T0              PIC X(02) VALUE SPACES.
              10  INSC-T0                   PIC X(14) VALUE SPACES.
              10  NOME-EMP-T0               PIC X(30) VALUE SPACES.
              10  TIPO-ARQUIVO-T0           PIC X(06)  VALUE SPACES.
              10  BRANCO1-T0                PIC X(446) VALUE SPACE.
           05 REM-TIPO1.
              10  CONVENIO-T1               PIC 9(06) VALUE ZEROS.
              10  CARTEIRA-T1               PIC 9(02) VALUE ZEROS.
              10  VARIACAO-T1               PIC 9(03) VALUE ZEROS.
              10  SEU-NUMERO-T1             PIC X(10) VALUE SPACES.
              10  NOSSO-NUMERO-T1           PIC X(20) VALUE SPACES.
              10  CONTROLE-T1               PIC X(25) VALUE SPACES.
              10  SIGLA-ESPECIE-T1          PIC X(05) VALUE SPACES.
              10  DATA-EMISSAO-T1           PIC 9(08) VALUE ZEROS.
              10  DATA-VENCTO-T1            PIC 9(08) VALUE ZEROS.
              10  VALOR-TITULO-T1           PIC 9(13) VALUE ZEROS.
              10  CODIGO-MOEDA-T1           PIC X(05) VALUE SPACES.
              10  QUANTIDADE-MOEDA-T1       PIC 9(13) VALUE ZEROS.
              10  ACEITE-T1                 PIC X(01) VALUE SPACES.
              10  VALOR-JUROS-T1            PIC 9(13) VALUE ZEROS.
              10  DATA-LIMITE-DESC-T1       PIC 9(08) VALUE ZEROS.
              10  VALOR-DESCONTO-T1         PIC 9(13) VALUE ZEROS.
              10  VALOR-ABATIMENTO-T1       PIC 9(13) VALUE ZEROS.
              10  QUANTIDADE-DIA-PRO-T1     PIC 9(02) VALUE ZEROS.
              10  MENSAGEM-T1               PIC X(40) VALUE SPACES.
              10  CONVENIO7-POS-T1          PIC 9(09) VALUE ZEROS.
              10  CODIGO-MULTA-T1           PIC 9(01) VALUE ZEROS.
              10  DATA-MULTA-T1             PIC 9(08) VALUE ZEROS.
              10  VALOR-MULTA-T1            PIC 9(13) VALUE ZEROS.
              10  FILLER-T1                 PIC X(09) VALUE SPACES.
              10  TIPO-INSCRICAO-AVAL-T1    PIC X(02) VALUE SPACES.
              10  INSCRICAO-AVALISTA-T1     PIC X(14) VALUE SPACES.
              10  NOME-AVALISTA-T1          PIC X(37) VALUE SPACES.
              10  PENDENTE-IMPRESSAO-T1     PIC X(01) VALUE SPACES.
              10  TIPO-INSCRICAO-CLI-T1     PIC 9(02) VALUE ZEROS.
              10  INSCRICAO-CLIENTE-T1      PIC X(14) VALUE SPACES.
              10  NOME-CLIENTE-T1           PIC X(37) VALUE SPACES.
              10  ENDERECO-CLIENTE-T1       PIC X(37) VALUE SPACES.
              10  CEP-CLIENTE-T1            PIC 9(08) VALUE ZEROS.
              10  CIDADE-CLIENTE-T1         PIC X(15) VALUE SPACES.
              10  UF-CLIENTE-T1             PIC X(02) VALUE SPACES.
              10  ESTADO-DESCRICAO-T1       PIC X(40) VALUE SPACES.
              10  DATA-PAGAMENTO-T1         PIC 9(08) VALUE ZEROS.
              10  VALOR-PAGO-T1             PIC 9(13) VALUE ZEROS.
              10  TIPO-MODALIDADE-T1        PIC 9(02) VALUE ZEROS.
              10  ESTADO-DO-TITULO-T1       PIC 9(02) VALUE ZEROS.
              10  USO-DO-BANCO-T1           PIC X(16) VALUE SPACES.
           05 REM-TIPO2.
              10 QUANTIDADE-T2     PIC 9(06)  VALUE ZEROS.
              10 BRANCO-T2         PIC X(492) VALUE SPACES.

           05  EMP-REFERENCIA.
               10  FILLER            PIC X(15)
                   VALUE "\PROGRAMA\KELLO".
               10  VAR1              PIC X VALUE "\".
               10  EMP-REC           PIC XXX.
               10  VAR2              PIC X VALUE "\".
               10  ARQ-REC           PIC X(10).
           05  EMPRESA-REF REDEFINES EMP-REFERENCIA PIC X(30).
           COPY "PARAMETR".

       77 janelaPrincipal              object reference.
       77 handle8                      pic 9(08) comp-x value zeros.
       77 wHandle                      pic 9(09) comp-5 value zeros.

       01  MASC-DIA                 PIC Z9.


       01  CAB01.
           05  FILLER               PIC X(115) VALUE
           'RELATORIO DE REMESSA - BANCO DO BRASIL'.
           05  FILLER               PIC X(09) VALUE 'EMISSAO: '.
           05  EMISSAO-REL          PIC 99/99/99.
       01  CAB02.
           05  FILLER               PIC X(132) VALUE ALL "=".
       01  CAB03.
           05  FILLER               PIC X(132) VALUE
           "NOME                                ENDERECO
      -    "            CEP       CIDADE          UF DOCUMENTO
      -    " VALOR".
       01  LINDET.
           05  NOME-REL             PIC X(35) VALUE SPACES.
           05  FILLER               PIC X     VALUE SPACES.
           05  ENDERECO-REL         PIC X(35) VALUE SPACES.
           05  FILLER               PIC X     VALUE SPACES.
           05  CEP-REL              PIC ZZZZZ.ZZZ.
           05  FILLER               PIC X     VALUE SPACES.
           05  CIDADE-REL           PIC X(15) VALUE SPACES.
           05  FILLER               PIC X     VALUE SPACES.
           05  UF-REL               PIC XX    VALUE SPACES.
           05  FILLER               PIC X     VALUE SPACES.
           05  DOCTO-REL            PIC X(11) VALUE SPACES.
           05  FILLER               PIC X     VALUE SPACES.
           05  VALOR-REL            PIC ZZ.ZZZ.ZZZ,ZZ.
       01  LINDET1.
           05  FILLER               PIC X(20) VALUE 'VALOR TOTAL.: '.
           05  VALOR-TOTAL-REL      PIC ZZ.ZZZ.ZZZ.ZZZ,ZZ.
           05  FILLER               PIC X(20) VALUE SPACES.
           05  FILLER               PIC X(20) VALUE 'QTDE TITULOS: '.
           05  QTDE-TIT-TOTAL-REL   PIC ZZ@±s;J0V È´%À           Aî0ðd â-É   À  ¸0£Ìð0Â 0å(À           ßò 0Ðm ½À           áÓ0n ¿À           áÓ0¼g 0À           í0­« ð*À           ³ù0	} ð¥°æc   À  1"ìc0úÎ HL)À           Ô0àO    sÀ    À       Þn0Ä 7yÀ8       §2 éü0i°  À_éâ    À  x$¢0ò   À           902  §À           áí	00á x²â    À  H©gð0C `Gæø   À  ð"¯o0%  ÀÀ            Q0n  PÀ           0G À           È0¬® æÀ           e}0AY
  9 ÀÃ(       Ó¾  î0ga  ¨ vÀ    À       :Ë0T   oÀ           ø0Äº ÐK ÀFÝ       RÆ  ZG0 Æ ÀÂ    `   dÓ d¯0¥0  °MÀ           ¾û0É·  ¨4åP   À   þ59%0  P$À           Çô0b ð9çÈâ   À  Ì@Ò0Ìp hûãø   À  `Q|ú0K
 HÈ-âö   À  $á0C/ èrÀ    À       *Û0â  'À           @0Ùz §À           Å±0Ð 8ùÀ           .0Ò· ñmäÐý   À  @/60s¥ ðÜÀ           	0r Àî½5
   À  °	>0£a ¬%À           ¹0×h ÷!áTj   À  \Ð^0¾ ¨¤2À           k,0%   ÒÀ           0%  @ÙÀ           	0þt  NÀå÷   À  (ægy0Û¢	 Ø¸âåÙ:   À  Ô=U0Ï pÌãÚ   À  ÐHi0f'  8ãÀ           ùÀ0ë °¸âÜð   À  Øß
0Å
 7À           ×	02	 ¨â   À  ð©½ð0ìo `ë    À  [tIY	01ç	 @â   À  `ôYÑ0 ÊÀ           5¹0=  hÀ           00 h"áãÄ   À  20ëÙ Xà±âôÍ	   À  Ð×?m0ÿ  À           Ó0J  ^À    À       [0µ³ ÀÌsærô   À  p@´
0*½ P¸â§v   À  ØÜÝ
0ëE è
â^{
   À  Ð1£5ñ0e ¨æÝ¾    À  hSv)0nù Ð°mä)<   À  (-gñ©0+ý    À           g0  Ð¾À           ­0e[ ¨Çîñ   À  °	
 0èZ ÈTâ3
   À  `1£ó02 ¤âðõ    À  ô×[È00  (Há÷5   À  Ð Gö0ã ;áâ   À  Ð\Hù08  ôî/   À  °	½ò0	 PÀ           ã0áÈ h)À           â0^ &À           ø0ù `»ºáw¥   À  Ø~çfà0¦Ö Ð"´åÿ´   À  XÇÎÂ
0ã   À    `       c½0x  â    À  ©ð0Ùµ ( ,î3	   À  y6=ú
0 o °ÆGá2D   À  Ð G½ú0µ (®À           8ó	0Cß ¨3Ûã½   À  À½}¥j0B   ÙÀ           $à0ÿÂ L ÀÂø	       ­  Ï0D~ ãî    À  À{uÎÁ0ÿ  `Ö À    `       ©0 âq   À  °ÍK0C  ¨¡ À           H0ÁÀ  ðìÀ           dQ0µ pÄÀ           ä`0}C 8(â    À  `©Îï0¸ ÈMBå{Ó   À   #90Kl pvâÒ   À  `©Só0tm ð(íá
8   À  hxÉQþ0M  ¨Ô±á"	   À  @ð:´Z0o  è À           E 0v© @ìÀ           Ô0¤  À           QZ0ï® xÀ           0ò (âd   À  `1£ô0Æ   ý;À           Èº0O àìÀ           Ä{0GÕ ÐêÀ           yû0I è-À           íB0Ã+ ©NqÀ         V0Ë  àÀ           ª0Ü  PÉÀ           k@0¤_ É%À           UÂ0	  ÆqÀ    À       (0} 8½å    À  @ 0C 8À           Ï	0ÒÌ  0^rÀ    À       00ò  "À           û0aæ	 °Aâ ç   À   é<3 0»¬ X{À           Ó»0"& °:â`ß   À  H*:? 0ãM }ÁæÞü   À  î-0¥u 0 
â!4   À  Ð1£vñ0  Ê2À           ¨0¨ Pâd   À  1£Að0Ô À           ÈÆ	0   ZÀ    `       v0éH ¸pä'{   À  ÀY\Oæ0  U,â    	       ´þ	0"  2À           f0qÿ
 HîïÀ   À  °	 0z è3À           ]Ï0B hÀ           ï_0¿p ð=À           Ã0°´ Ð½î®K   À  àI9ö0ê ýå¯ø   `  ÀáøSA0²^	 ¨ð	â/¿    À  2£kñ03# ø#Ìã0D   À   áé8f0  Ã¨æÛ   À  hS:F0t ÐÔ
À           tQ0´  °jÀ           U0x
  0 À           ?0v È9	âùc   À  2£ô0(  8\À           f0» pä8F   À  H~ç
0¼­
  #â¹k   À  À«©¾ñ0üo x©á:	   À  ÐÒë0»ò ø÷Àþ-       º º	0Ë h3À           80ò  ¥À           	08  ¸÷6å    À  x;ë0s	  8^À    À       X,0Ú    `À           _ý0Ø àÂÀ           s0
 èíáBÂ   À  hxÉþ01o  ÎÀ           (#
0î ¨À           òÞ0ß ÀtÀ           \}0$ pÿâA   À  Àq_0¯ È³,îê   À  y6¾¥0 8ÕÀf        ð0|   À            [0«R ¨À           K­0   D`À           Ê¦	0k  ðøqÀ8    À       '¸0¾& @1rÀ    À        Ê0/ 0}$À           á°0 a2À           0LP  À           Ý?0í  uÀ           ³I
0a  °_>À            w0à  øÀ           0¯ç	  
Aâ¨ä	   À   é<3 0×ï `xìèó   À  ø¦f¢ 0m `,,çÖØ   `  XvØ0¯  ÀÁºã    À  03`|0W>  x|À           <ê	0n  @
 À           «(00 ø=áãë	   À  P<h:0C Xí«è÷   À  ø|Wµø0|E À1Ûã»P   À  À½}¥j0]æ Àz!À           p0ß5 hÀ           ?0ê 'À           v0| à°À           JÇ02  x3À           Á0%  &â  
   À  ÐeÞ.ò0"®  °]À           ²Î0õ  ÐtJî    `   ÜCÙ0Ë  ¨;À           Á0  xiè    	       ô0éI ØÎ:â'Â   À  H*: 0 ¸Â ÀªP    `   OÒ  L	0  "^À    À       ©0,	 ¨ýâÕ   À  ô×àÇ0K  À           Ó0Ìþ	 h¨¹á²æ	   `  ejß0ñi X0;è   À  x$6¹~05  PÈã    	       w0q| p¬{â/"   À  Ør½bÝ0cÉ îoZ   À  °	 01 @ÀõÑ       7 y¡0ÄZ Õ%À           ¸u08í `6áã«^   À  P<h:0¹ ¸â´_   À  0¬©­ñ0·Æ 8 :âµ   À  H*: 0õ xCâT-   À  `©ð05 
À       DÊ  Ü0/è HqÀ    À       )0¦E  vÀ           wÊ0=Ê ((;áÛè   À  Ð\Iý0lö  `Ù·ã       øJµß0  Ø! À        ¢Ô n"0ä  0àpå    À  h=dÜ<0Þ   8rÀ    À       -0ÁÏ è&À           >0  Ð)Iî       n«#0  ¼á       ÈJD7Û0ò] ¼À           ½
0¤Þ Ðç&À           ¥µ
0£4 (Òî²   À  °	0G  ÕSâ^   À  4B0HE  oçü   À  H_P¬a0	 øúæÛ   À  È0F|T0(  ÄÀ           áÐ0%a YÀ           
ó0Öl ¨AëØ­   À  8¶Ô0Ä  _À           ¥Å0B· (J(À           îj0u  Ð À           Þ0~  õâÎ¿    À  0¬©«ñ0Ã» XâÀ           [Ü0    `À           JO0¨ xüãÑª   À  x-!¯0@ï pm!À           î0þm sÀ           bC0V ðâ   À  ©ð0Ðè	 Ø
Aâô   À   é<3 0  8À           ¾î0× ØÖÀ           IÍ
0ÚZ H,À           ó­0[)	 hb:âÙ0   À  H*:= 0   À           ©0ÿ R°æ¿   À  1"¼00A @À           'þ02   Ñ À    `       lx0 É z¹á
   À  Ø>{ãã0&$  ï+À           
q0¢ PK¸áàº   À  Ðÿ¸îå0w Ø°§â!n   À  àþ:úb0  àÀ           5n0¦; øzâcé	   À  ¸©ð0ï ¸ñÀ           E60£i pÜÀ           &80é
 h ¹â¦    À  Ø£×0ñ} ØºÀ           JÇ0£ È<â    À  ©ð0ëà  `¿á¿z   À  ø!Ä0n ÈíáuR   À  hxÉÏû0!Ø hwÀ    À       ¿0ðÈ HCÀ            ×0g¬ À0À           ð00y
 H¸Èån   À  `£U/Y01¦ ªëï'
   À  °OAf0ë ÈÂ Àò	    `    çN0óí 8pwäñÚ   À  (µT+00ý  ]À           f0é5 À           ?0oý 8µ*À           "0*Þ pvÀ           úk	0Uj `¦1À           *07Ð P)À           0»  U;À           ù0Ìy  øiÀ           V06 (
À            ¶0¨k  ¤À           ÷>0Ä  ± À           0j ¸é
â   À  Ð1£:ñ0Â. økæ½y   `   GOØ/0w	  Há-   À  Ð Gø0p  ØÐ À    `       pó
0²  ÒÀ           0ô ÎsæAG   À  p@´
0p½ (À           Kâ01¢ ð_éâ    À  x$¢0ô  (ã:â[Ê   À  H*:E 0DM xi%À           *ì
0¾   gÀ           %M0t `¹2À           £É0Î èÝáÉA   À  P!î0®  (µÀ           0à  ðaã    `  pgµ{0* ¸,À           0, À1 À
       È  òe0N 8+âÑ1   À  À«©¾ñ0-  (Ü;À           ûH	0­  7ä    À  Ðô
å0Ó| PVåÎ®   À  Ø°æR0q¤ Ð.ë    À  [t-0  àÀ%À           UÂ0Cr H2À           Ï	0!Ø   â    À  ø«©Tô0 à33À           Yá0Ì  (F	À           00<» °¨À           /=0   Èã    	       %¿	0# X×SâÚÒ   À  4B0Y] xMâ>   À  `1£Pñ0Þà 8	'À           ¬¢0   (0`À           ¢¡0ßì p8*À           Üý0c ºÀc       L r50ò  0^À    À       Ý0  ¸XÀ           90Ä  p<À        -¥  0  à¥â    	       ½0¦ ðÀ$5        cå0'¿ @Ü¸â¤¶
   À  Ø`Ü
0¨  ¨Èâã    	       B0¢ ¸#À           ³ù0¬  Ð$À           Çô0  w À           Ry0( àTâèZ   À  `1£ó0Úb h0ªá§   À   6^$Â0,F 8<.âî·
   À   #à0± ðÀ           ÈÆ	0Ì8  hâ    À  ø«©ô0Û>  P¤À           ÙJ0d   Xù;À           O0× »&À           ¨d
0 À=À           Á0Î  ¸ÜÀ           Ko0¶:
 0Îâô    `  Àô¦0Ñ)  0À           ?±0à¼  8ÐÀ           ©0&} À            0«  0":À           RU0é¼ ¸¯À           /=0} ÐiÀ           30ä$  ÈßÀ           o0îg %À           áê0_Ë 	À           0£   ^À    À       	0Ln  hVÀ           Ây0-  À^À    À       t>0
 Ø|ÀA       -Æ 

0Ä
 @ÀÂ       RÎ A0È  `hè    	       ô0Hg Ø<¼â      Pc0òá  	ë    À  @±sy0Ë ü¼á(   `  °Ùfç0 ÐîS   À  °	 0¼  ZÀ           Ây0v pY2À           À"0þb  íÀ           &ñ04 (ºâ    À  À«©ñ0m H¥ë    À  §sÁ¿
0­8 H,À           0KT Øôìá¾   À  hxÉÎû0Mz  8
À           Ïn0  XÎÀ           Üð0	  `¨À           áí	0ÿe À           ±Õ0Ö Ðî±   À  ÐLÀÚ0²	 xÍ#áTé   À  Ð_¯|0µ  Rë    À  ¨4»-0ã±   SÀ           ²Î0û#  ð À           E©0L% =#À           ¿
0[ä ágwÀö    ¿     ZO0ë  À           X0@   À           ÿc0ì  pEÀ           n 0_¹ 8vâU)   `  HRUî0þ   hâ    À  ©Òò0¤I âÄ8   À  ©Dð0õ  ñÀ           ¦{0c÷ @ª{âá   À  Ør½bÝ0
 Xý-â¢j   À   #Yà0P ÀEÀ           ú0Ò °±À           »÷0®*  øSÀ           #ô	0 `AÀ           Á0o x*À           áê0B+ 8âê«   À  ©\ó0   Ð/`À           e70O ØsÀ    À        0Ð  ø¿ À    `       é×0±  KÀ           !¯0ð% Pòâí^
   À  0¬©«ñ0² 0_+À           7ª0u1 ÐMæ   À  ¡Ú0fP XðÈå|Ê   À   ;©ô·0  õ;À           âB0zz À           q¸05	 Ã¸âý   À  Øßà
0f¶ HªÀv\       Nî  ;Ü0/L Ø6À           uº0W °Öî÷    À  °	0y 8	ã·¼   `  ¨O	0T  ; À        Ù  t0¾t xíå9   À  hh.0^½  SÀ           -´0  KÀ           î¶0Å   ÐáÀ           ùÀ0Ç7
 ¨Áâãø   À  Í0Jc °À>çþ3   À  xBÑPF0$ (¥+À           Ëm0h 0ùíâP       &tÓó0.   pÀ           |©0Þ Á+À           70Ö  ¼À           »÷0P 0%À           #!
0«a  èÀ           wè0¬è Rã    À  (¼p9£0Ö  8À           ¯0«R "À           0è  À           <Á051 xC¯âz   À  ø­eÞ0 ø=uæh   À  8HÁ'0¡   íáL¬   À  hxÉü0Â ¨tÀ           0·l PÑÀ           &80 ¿ À           0Iø ðÕ!À           ÛP0r `D>ÀK£
       §ü  Å0å @P±á   À  ÐÿF	01
 (í?å¶
   À  Å{Ãn0ih P1À           &
0?Y ø@ë>   À  8¶Ô0X ÁyäV;   À  (o¤	V
0KÈ `6À           h´0ãÉ GÀ            ×0
@  ù$À           ~0\, ºá®]   À  ßê
0Ù¢ ¸v À           04 x¼ïá=   `  /Vþ0"m ((À           áê0½6  ,À           ¤+
0bê	 pæ4   À  °Ò}ð1
0" Díáá   À  hxÉSþ0£ ÈÓÀ           Ã0ª ¢+À           Ëm0Í   ¤ À           i0&¼ m·á¤Ë   À  X/Þ0¨  xõ;À           0÷  P À           Ô0©Ã	 Cä§ú   À  pö9¥ß0ì. Pp-äeR   À  ø¸ØÒ0k
 ÀiÍ       xÌ B0ú) X2À           »
0.ø »â*    À  0£ó0% ¸ãÀ           #0*Ï à¾À           @0^ô
 Pæn    À  Øn=f0×H táãìn   À  P<hFd0ñ2 ¸ÎÀ           0³í	 ã1   À  ¨Ùð0%h ÐÀ           ¤0ã   ;â    À  ô×dÁ0§  ØÄæ       1íô0äq P/À           i0W  À^À    À       ,ç0  øuÀ           |©0   ÀL>À           øÑ
0)  ô+À           ßF04  ¸QÀ           m`0  À^À           ï0¬  à­À           ?0Põ XpÀ           6_0 `øä<   À  @/>¶0é ¨âZð   À  ©åð0+ ¡â Ð   À  ô×[È0ÑE 87íáóL   À  hxÉRþ0\ø X*À           [w0L á*À            X0 Tâj
   À  `1£ó0  ð{À           |©0³Ô 8å¡	   À  §5zN0â 8¿
À           gÅ0È  PíÀ           r0Ê È·,î^(   À  y6¾¥0  à>úå
q   `  /e·0M (Áâ`
   À  ©(ñ0  g À           p
0O, hbíáËQ   À  hxÉUþ06  0É À           0=  ä"á    `  JC0Ù  8&â    	       0ä¹ @ãÝ   À  Øa£0ç	 xAâ¼æ	   À   é<3 0I  HÖ À    `       # 0  ð`À           %M0Ki (NÀ           á.0  á À            Q0T[  À           dC0ùi £1À           *0 Øhãf   À  Áñd0ÿy ø¾*ç   À  Ø6,á 09 (;hãÛ^   `  àø+x00N ¨LÀ           90« pbÀ           ±Ï0aã (±âî	   À  ¸©Çï0ÿm ¾À           áÓ0à; 	sÀ    À       ?½0£ Üfí!
   `  j8
0¥Å ÀWâ¢   À  1£Að0îÄ ðPÀ           ä0C  0{â    	       E0¾  ÀÀ           çø0]"   À           ©w0Ç&  ò	À           O_0  X#ã    	       h0. C,À           
ý	0È»  rÀ    À       0  {À           |©0,  0^À    À       ¦È0d# À           Kj	0õ¨  Xâ    À  (©¬ð0r` Ëâo   À  1£Hñ0
   Øþ?À        ô,  0Ê0M @À           |#0 ðO
À           aD05 ÈÀ           ¨q	0  ² À           s»07í @âôþ   À  ÐeÞuñ0`o  8÷À           Íº0p[ :À           )0ü  Ø&À           Çô0  °À           ÐK	0| @À           KV0   ^À           #ô	0µ ø(À           ¬Þ0ßE ¸À           o0 hÀ           80  ÜÀ           .	0éù  ØÀ           Id0q Hâ    À  0¬©¥ñ0Äø (h:âB
   À  H*:= 0÷  @À           î¶0£    ² À           Ä°0ùg °Åâ¯·   À  Í07A ÈâxÑ   À  ô×âÀ08í À¤ À	µ        ×|0= TäG   À  H$÷¬û0O  À           Ý?0Ð&  ¥À           W0¹  h\À           ¾0N °àãå   À  Hc;g¹0Ïè Ôìá
   À  hxÉû0Qþ	 ø þåM   À   wòÊÉ0  |ÿæ    `  ¬@	0²°  8pÀ           uæ0O8 Ð¿$À           	l0~ 0?À           0ü0U ÓâSE	   À  Ø7_À
0» ÐL
âV¢   À  Ð1£°ñ0Ö  ð
À        1m  H0}ò  Há   À  Ð Gö0  ÀÀ           00Û
 À           è0Òp AÉëÒ=   À  PÖ 0å
 p£âx   À  I0¡G 8¹ã8   À   ßf	08	 P°âC   À  PÄÃå
0  È¬ À           ÂT
0  ¥â    	       ½0 ¸À           ß¥0   Ç À           ÑÞ0¿ã @ØãÏÖ   À   qM	0aW ØÊñæ¢M   `  ]Ua0;¢ ØÔÀ            ë0Ð p2À           fè0>ê (ç¨æQÛ   À  hS|R0¨ `Eõã¦   À  çïÄ	0ã h'À           @0«  Vâ¨Ì	   À  ©Áï0.  -+À           Ë0- ¨q$À           á°0Ý p À           ãm0 (À           Ö¨0`   À           ì0ç  À           ß¹01¤ Zºá¯¼   À  àãà0£  ¸k9À        } nb0¾e xnéâ¨   À  xe0¶¸ `À           À¿	0½å 0óÀ           |Á0¯B `Ý,À           %í0â
  ØÀ           E0ÛÁ  `ôÀ           ÿT0  8RÀ    `       v0ª â    À  ø«©ô0ûp øÊã9â   À  (CX.­0Ä  ¨uÀ           F0ý~ haºá{o   À  Ù~Ñè0å[ 0À           W20ÿ :¾ãýh   `  (ù`É0Àô ¾:â~@   À  H*: 0áq   ¹À           ±0â  %á    À  ¸A)ä!	0÷ ð¥îãÁt   `  ¸þ_ùC0¨µ HÇÀ           Ì0æg xÀ           'Å0  &9ãDÌ
   `  °=»l0N  ð À           ß0C 0À           í0Ì³  hæÇî   À  ØÃF0ÝÃ  Ñ·áº   À  ÐB<·0=»  ø%	ë    À  @±s:±0&  ° À           ÁF0Èñ ^*À           L<
0 (ÅSâÚ    À  ³A0Áº èª(À           MY0] 8,â¸   À  (©Þó0T9  â    À  (©­ð0¨  ð À           O
0dÁ  ¦	â    À  2£¦ñ0/ è+À           0ïD °ï,À           D 0 	  ¶ À           W04 PéÀ           Í20° P-âV¼   À  $JÞ0±÷  *À           [w0æ XAâ¤á	   À   é<3 0Q Ø%À           #!
0~
    À           ?0` öâã[ù
   À  8*T0I´   wÀ    À       ¿0    ¿_À    À        X0[  ¸ÿÀ           	0	â Ðá)À           Ë0bÕ híáø÷   À  hxÉü0£ ðÔ:á_i   À  Ð\Äú0+ À ,îv¹	   À  y6=ú
0øä À À           v0aF x1À           ½ò0  ÜÀ        7è éd0Ã_ @]À           ñ0ä ÐéÀ           #0¥$ p~À           {0g  hÓ À    `       }ç0©Ý p À           Ç0¬  Nâ·   À  H© ó0µ   àÀ           gR0¯· À1¯å¶Ú   À   aí÷E0y²  Ø	â    À  2£eñ0K `¯À           É0Ü °ÕÀ           ³Â0¨û   /À           
0:ª  Mæ;   À  bóò0õ `Píá3;   À  hxÉTþ0mc ¨p4ãl¼   À  xjr9«0¸   Ø À           ê508f	 ²¸âõN   À  Øß
0¾ XÉ+À           70:Ý @8â·   À  1£¿ñ0Õ  ¸¥â    	       ü·0  5"À           AÚ0»d øÛÀ½Ý       ÿ  |Ã0[  ÕMæÓ   À  ¡Ú0êÓ »À           ;0¾« Èvâc   À  ÐeÞ3ò0
 Ð1 À           a0+d ¨qÀ           ±Õ0D   À           h0  ËÀ           eh05  SÀ           F0u À"À           j
0-(  h¥À           W0r{  ()wÀ    À       Í½0!î i!À           î0±  â    À  `©ó0Ë QkãÉ   À  ðzù¨0   ½À        [å kÑ0@# PÀ           x©0e ð	#À           Yn0¶ ´À           q0v Èê&ä   À  P)Wr0O pbCåË   À  2ç·00° èÀ           À¿	0¶  PñÀ           	0¶N   qÀ           \}0¯  \ À           Â	0Óá  õ	À           O_0öë	  ´ãï   À  pRoÓ0îÏ (å&u   À  ¸íhP0  È^À    À       e0  PâÀ           Vj0zÞ  Éâ    À  ÐeÞøñ0$ 4#À           ¿
0ÞÎ Ðâ[·   À  ð©½ð0 ^2À           À"0kú ¡*À           Nû0eO  æâw	   À  ¸0£
ñ0P  ðI"À           @(0^ pÛân
   À  0£ó0£í È ºã¡Ï   À  È$xØº0ü6 pº$À           	l0¦\ ðìâa3   À  ð©zð0¨¦ àíâ$
   À  À
	¿80N"  ÈN À           S0   v:À           ,ó0iý
 À¨áfé   À  È|Gfã0Z   ¥èâ    À  °©M¦0  rzã    	       ¯£0 HíáÄ   À  hxÉSþ0W  hOÀ        &m  ´Æ09 à â    À  À«©ñ0Tå  °Æ5ç Í   À  ¨8Z)0Eü èÁ	À           "0¿ ÇÀ           çø0=  À!À           	<
0è2 xíá    À  hxÉÏû0´í 8íâ²8   À  `1£Zô03S \âÂ&
   À  À«©Áð0p Ø6À           Ã0qØ èõFæ;8   À  ð"¯-ë0×  píÀ            0* àÑÀ           .	0z
 8ûî¸   À  0?.07¦ ¸ÏÀ½u       í 1:0©ß HIÀ           10l `DÀ           Îe0  hÜÀ           /0ðÙ ÃÀ           åä0"  Ø À           4=
0/S È%À           ë0¾È èKâ!   À  `1£Pñ0
 ¨:íáÁé   À  hxÉRþ0H `-À           ±(07z  hQâ    À  À«©Áð0 P% À           h0ÇN ÐÖyãEù   À  ðãG¯0v XúGá÷Þ   À  Ð Gû0Í  üä   À  ìGH0q  G-CRITICA

           MOVE "REFRESH-DATA" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.

       ATUALIZA-SEQUENCIA SECTION.
           CLOSE SEQBRAS
           OPEN I-O SEQBRAS
           MOVE 1 TO CONT-SEQUENCIA.
           READ SEQBRAS.
           MOVE SEQUENCIA-W       TO SEQUENCIA.
           REWRITE REG-SEQBRAS.
           CLOSE SEQBRAS
           OPEN INPUT SEQBRAS.
       ABRE-ARQUIVO-ANOTACAO SECTION.
           OPEN I-O CRD200 CRD201.
           IF ST-CRD200 = "35"  CLOSE CRD200  OPEN OUTPUT CRD200
                                CLOSE CRD200  OPEN I-O CRD200.
           IF ST-CRD201 = "35"  CLOSE CRD201  OPEN OUTPUT CRD201
                                CLOSE CRD201  OPEN I-O CRD201.
           IF ST-CRD200 <> "00"
              MOVE "ERRO ABERTURA CRD200: "  TO GS-MENSAGEM-ERRO
              MOVE ST-CRD200 TO GS-MENSAGEM-ERRO(23: 02)
              PERFORM CARREGA-MENSAGEM-ERRO.
           IF ST-CRD201 <> "00"
              MOVE "ERRO ABERTURA CRD201: "  TO GS-MENSAGEM-ERRO
              MOVE ST-CRD201 TO GS-MENSAGEM-ERRO(23: 02)
              PERFORM CARREGA-MENSAGEM-ERRO.
       GRAVA-ANOTACAO SECTION.
           MOVE COD-COMPL-CR20 TO COD-COMPL-CR200
           MOVE ZEROS TO SEQ-CR200 ULT-SEQ.
           START CRD200 KEY IS NOT < CHAVE-CR200 INVALID KEY
                 MOVE "10" TO ST-CRD200.
           PERFORM UNTIL ST-CRD200 = "10"
             READ CRD200 NEXT RECORD AT END MOVE "10" TO ST-CRD200
               NOT AT END
                 IF COD-COMPL-CR200 <> COD-COMPL-CR20
                              MOVE "10" TO ST-CRD200
                 ELSE MOVE SEQ-CR200 TO ULT-SEQ
                      CONTINUE
             END-READ
           END-PERFORM.
           MOVE ZEROS          TO SITUACAO-ANOTACAO-CR200
           ADD 1 TO ULT-SEQ.
           MOVE ULT-SEQ      TO SEQ-CR200.
           MOVE COD-COMPL-CR20 TO COD-COMPL-CR200.
           MOVE ZEROS        TO DATA-RETORNO-CR200
           MOVE USUARIO-W    TO USUARIO-CR200
           MOVE DATA-DIA-I   TO DATA-MOVTO-CR200
           MOVE HORA-BRA(1: 4) TO HORA-MOVTO-CR200

           MOVE ZEROS TO ST-CRD200.
           PERFORM UNTIL ST-CRD200 = "10"
              WRITE REG-CRD200 INVALID KEY
                 ADD 1 TO SEQ-CR200
                 CONTINUE
               NOT INVALID KEY MOVE "10" TO ST-CRD200
           END-PERFORM.

           MOVE SEQ-CR200      TO SEQ-CR201.
           MOVE COD-COMPL-CR20 TO COD-COMPL-CR201.
           MOVE "TRANSF.PORTADOR- DOCTO: XXXXXXXXXX - 99-XXXXXXXXXXXXXXX
      -    "X P/ 99-XXXXXXXXXXXXXXXX" TO ANOTACAO-CR201.
           MOVE NR-DOCTO-CR20       TO ANOTACAO-CR201(25: 11)
           MOVE PORTADOR-CR20       TO ANOTACAO-CR201(38: 4) PORTADOR
           READ CAD018 INVALID KEY MOVE SPACES TO NOME-PORT.
           MOVE NOME-PORT           TO ANOTACAO-CR201(43: 16)
           MOVE GS-ACP-PORTADOR     TO ANOTACAO-CR201(63: 4) PORTADOR
           READ CAD018 INVALID KEY MOVE SPACES TO NOME-PORT.
           MOVE NOME-PORT           TO ANOTACAO-CR201(67: 16)
           MOVE ZEROS TO ST-CRD201.
           MOVE 1              TO SUBSEQ-CR201.
           PERFORM UNTIL ST-CRD201 = "10"
             WRITE REG-CRD201 INVALID KEY
               ADD 1 TO SUBSEQ-CR201
               CONTINUE
              NOT INVALID KEY
                MOVE "10" TO ST-CRD201
             END-WRITE
           END-PERFORM.
       MOVER-DADOS-TIPO0 SECTION.
           MOVE 1 TO SEQ-W.
           MOVE "00"                     TO ID-REG-REM.
           MOVE "02"                     TO TIPO-INSC-T0
           MOVE 10874260000140           TO INSC-T0
           MOVE "EDA FORMATURAS LTDA ME" TO NOME-EMP-T0
           MOVE "CBR500"                 TO TIPO-ARQUIVO-T0
           MOVE ZEROS                    TO BRANCO1-T0
           MOVE REM-TIPO0 TO DADOS-REM.
           WRITE REG-REMESSA.
           MOVE REG-REMESSA TO REG-REMESSA2
           MOVE X"0D0A"    TO  PULA-REM2
           WRITE REG-REMESSA2
      *    AFTER 1
           MOVE ZEROS TO VALOR-TOTAL QTDE-TIT.

       MOVER-DADOS-TIPO1 SECTION.
           INITIALIZE REM-TIPO1
           MOVE "01"                     TO ID-REG-REM
           MOVE ZEROS                    TO CONVENIO-T1
           MOVE GS-CARTEIRA-BCO          TO CARTEIRA-T1
           MOVE 019                      TO VARIACAO-T1
           MOVE SPACES                   TO SEU-NUMERO-T1
           MOVE NR-DOCTO-CR20            TO SEU-NUMERO-T1
      *    STRING CLIENTE-CR20(1:4) NR-DOCTO-CR20 INTO SEU-NUMERO-T1

      * CALCULO PARA O NOSSO NUMERO -> BANCO DO BRASIL

           ADD 1 TO SEQUENCIA-W
           STRING "2085583" SEQUENCIA-W INTO NOSSO-NUMERO-T1

      *    STRING "178157" SEQUENCIA-W INTO TAB-SEQUENCIA
      *    MOVE 0                        TO IND TOTAL
      *    PERFORM UNTIL IND = 11
      *        ADD 1 TO IND
      *        EVALUATE IND
      *            WHEN 1   COMPUTE VALOR = TAB-SEQ(IND) * 7
      *            WHEN 2   COMPUTE VALOR = TAB-SEQ(IND) * 8
      *            WHEN 3   COMPUTE VALOR = TAB-SEQ(IND) * 9
      *            WHEN 4   COMPUTE VALOR = TAB-SEQ(IND) * 2
      *            WHEN 5   COMPUTE VALOR = TAB-SEQ(IND) * 3
      *            WHEN 6   COMPUTE VALOR = TAB-SEQ(IND) * 4
      *            WHEN 7   COMPUTE VALOR = TAB-SEQ(IND) * 5
      *            WHEN 8   COMPUTE VALOR = TAB-SEQ(IND) * 6
      *            WHEN 9   COMPUTE VALOR = TAB-SEQ(IND) * 7
      *            WHEN 10  COMPUTE VALOR = TAB-SEQ(IND) * 8
      *            WHEN 11  COMPUTE VALOR = TAB-SEQ(IND) * 9
      *        END-EVALUATE
      *        COMPUTE TOTAL = TOTAL + VALOR
      *    END-PERFORM
      *
      *    DIVIDE TOTAL BY 11 GIVING RESTO
      *
      *    COMPUTE RESTO = TOTAL - (RESTO * 11)
      *
      *    IF RESTO = 10
      *       MOVE "X"   TO DIGITO-VERIFICADOR
      *    ELSE
      *       IF RESTO = 0
      *          MOVE "0" TO DIGITO-VERIFICADOR
      *       ELSE
      *          MOVE RESTO(2:1) TO DIGITO-VERIFICADOR
      *       END-IF
      *    END-IF
      *
      *    STRING "1133379" SEQUENCIA-W DIGITO-VERIFICADOR "         "
      *      INTO NOSSO-NUMERO-T1

      *    MOVE ZEROS                    TO NOSSO-NUMERO-T1

           MOVE "X"                      TO CONTROLE-T1(1: 1)
           MOVE COD-COMPL-CR20           TO CONTROLE-T1(2: 9)
           MOVE SEQ-CR20                 TO CONTROLE-T1(11: 05)
           MOVE SPACES                   TO CONTROLE-T1(16: 10)
           MOVE "DM"                     TO SIGLA-ESPECIE-T1
           MOVE DATA-EMISSAO-CR20        TO DATA-EMISSAO-T1
           MOVE DATA-VENCTO-CR20         TO DATA-INV
           CALL "GRIDAT1" USING DATA-INV.
           MOVE DATA-INV                 TO DATA-VENCTO-T1
           MOVE VALOR-TOT-CR20           TO VALOR-W
           MOVE VALOR-W(1: 11)           TO VALOR-TITULO-T1(1: 11)
           MOVE VALOR-W(12: 2)           TO VALOR-TITULO-T1(12: 2)
           ADD VALOR-W                   TO VALOR-TOTAL
           ADD 1                         TO QTDE-TIT
           MOVE "09"                     TO CODIGO-MOEDA-T1
           MOVE ZEROS                    TO QUANTIDADE-MOEDA-T1
           MOVE "N"                      TO ACEITE-T1
           COMPUTE TAXA-JUROS = GS-TAXA-JURO / 100
           COMPUTE VALOR-ATRASO = (VALOR-TOT-CR20 * TAXA-JUROS) / 30
           MOVE VALOR-ATRASO(1: 11)      TO VALOR-JUROS-T1(1: 11)
           MOVE VALOR-ATRASO(12: 2)      TO VALOR-JUROS-T1(12: 2)
           MOVE ZEROS                    TO DATA-LIMITE-DESC-T1
           MOVE ZEROS                    TO VALOR-DESCONTO-T1
           MOVE ZEROS                    TO VALOR-ABATIMENTO-T1
           MOVE GS-PROTESTO              TO QUANTIDADE-DIA-PRO-T1
           IF GS-PROTESTO > 0
      *       MOVE GS-PROTESTO           TO MASC-DIA
              INITIALIZE MENSAGEM-T1
      *       STRING "PROTESTAR APOS " MASC-DIA " DIAS" INTO
      *               MENSAGEM-T1
           ELSE
              MOVE "NAO RECEBER APOS 30 DIAS DE VENCIDO" TO MENSAGEM-T1
           END-IF
           MOVE 002085583                TO CONVENIO7-POS-T1

           MOVE ZEROS                    TO CODIGO-MULTA-T1
           MOVE ZEROS                    TO DATA-MULTA-T1
           MOVE ZEROS                    TO VALOR-MULTA-T1

           MOVE SPACES                   TO FILLER-T1
           MOVE COD-COMPL-CR20           TO COD-COMPL-CG14
           READ CGD014 INVALID KEY
               MOVE SPACES                   TO TIPO-INSCRICAO-AVAL-T1
               MOVE SPACES                   TO INSCRICAO-AVALISTA-T1
               MOVE SPACES                   TO NOME-AVALISTA-T1
           NOT INVALID KEY
               IF CPF-CG14 > 100000000000
                  MOVE "02"               TO TIPO-INSCRICAO-AVAL-T1
                  MOVE CPF-CG14(1: 14)    TO INSCRICAO-AVALISTA-T1
               ELSE
                  MOVE "01"               TO TIPO-INSCRICAO-AVAL-T1
                  MOVE CPF-CG14(4: 11)    TO INSCRICAO-AVALISTA-T1
                  MOVE SPACES             TO INSCRICAO-AVALISTA-T1(12:3)
               END-IF
               MOVE NOME-CG14             TO NOME-AVALISTA-T1
           END-READ


           MOVE "S"                      TO PENDENTE-IMPRESSAO-T1
           MOVE COD-COMPL-CR20           TO COD-COMPL-CG10
                                            COD-COMPL-CG11
           READ CGD010 INVALID KEY
                INITIALIZE REG-CGD010.

           READ CGD011 INVALID KEY
                INITIALIZE REG-CGD011.

           MOVE COMPRADOR-CG10           TO NOME-CLIENTE-T1
           MOVE ENDERECO1-CG11           TO ENDERECO-CLIENTE-T1

           IF CPF1-CG11 > 100000000000
              MOVE "02"                  TO TIPO-INSCRICAO-CLI-T1
              MOVE CPF1-CG11(3: 16)      TO INSCRICAO-CLIENTE-T1
           ELSE
              MOVE "01"                  TO TIPO-INSCRICAO-CLI-T1
              MOVE CPF1-CG11(6: 16)      TO INSCRICAO-CLIENTE-T1
              MOVE SPACES                TO INSCRICAO-CLIENTE-T1(12:3)
           END-IF

           MOVE CEP1-CG11                TO CEP-CLIENTE-T1
           MOVE CIDADE1-CG11             TO CIDADE
           READ CAD010 INVALID KEY
                MOVE SPACES TO NOME-CID UF-CID.

           MOVE NOME-CID                 TO CIDADE-CLIENTE-T1
           MOVE UF-CID                   TO UF-CLIENTE-T1
           CALL "UTI0080" USING UF-CLIENTE-T1 ESTADO-DESCRICAO-T1(1:20)
           CANCEL "UTI0080"
           MOVE ZEROS                    TO DATA-PAGAMENTO-T1
           MOVE ZEROS                    TO VALOR-PAGO-T1
           MOVE GS-MODALIDADE(1:2)       TO TIPO-MODALIDADE-T1
           MOVE "09"                     TO ESTADO-DO-TITULO-T1
           MOVE ALL ZEROS                TO USO-DO-BANCO-T1

           ADD 1  TO SEQ-W.
           MOVE REM-TIPO1 TO DADOS-REM.
           WRITE REG-REMESSA
           MOVE REG-REMESSA TO REG-REMESSA2
           MOVE X"0D0A"    TO  PULA-REM2
           WRITE REG-REMESSA2.
      *    AFTER 1.
       MOVER-DADOS-TIPO4 SECTION.
           MOVE "99"                     TO ID-REG-REM.
           MOVE SEQ-W                    TO QUANTIDADE-T2
           MOVE ZEROS                    TO BRANCO-T2
           MOVE REM-TIPO2                TO DADOS-REM.
           WRITE REG-REMESSA
           MOVE REG-REMESSA TO REG-REMESSA2
           MOVE X"0D0A"    TO  PULA-REM2
           WRITE REG-REMESSA2.
      *    AFTER 1.
       CARREGA-LISTA SECTION.
           MOVE "CLEAR-LIST-BOX" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM
           OPEN INPUT REMESSA.
           MOVE SPACES TO GS-LINDET.
           MOVE ZEROS TO ST-REM.
           PERFORM UNTIL ST-REM = "10"
            READ REMESSA AT END MOVE "10" TO ST-REM
             NOT AT END
              MOVE REG-REMESSA(1: 2) TO TIPO-W
              EVALUATE TIPO-W
                WHEN 0  PERFORM CABECALHO-TIPO0
                        PERFORM LINDET-TIPO0
                        PERFORM CABECALHO-TIPO1
                WHEN 1  PERFORM LINDET-TIPO1
                WHEN 99 PERFORM CABECALHO-TIPO9
                               PERFORM LINDET-TIPO9
              END-EVALUATE
            END-READ
           END-PERFORM.
           MOVE VALOR-TOTAL        TO GS-VALOR-TOTAL
           MOVE QTDE-TIT           TO GS-QTDE-TITULO
           MOVE "REFRESH-DATA" TO DS-PROCEDURE.
           PERFORM CALL-DIALOG-SYSTEM.
           CLOSE REMESSA.
       CABECALHO SECTION.
           MOVE DATA-DIA TO EMISSAO-REL.
           IF LIN = ZEROS
              WRITE REG-RELAT FROM CAB01
           ELSE WRITE REG-RELAT FROM CAB01 AFTER PAGE.
           WRITE REG-RELAT FROM CAB02.
           WRITE REG-RELAT FROM CAB03.
           WRITE REG-RELAT FROM CAB02.
           MOVE 4 TO LIN.
       IMPRIME-RELATORIO SECTION.
           ACCEPT VARIA-W FROM TIME.
           OPEN OUTPUT WORK.
           OPEN INPUT REMESSA.
           MOVE ZEROS TO SEQ-WK.
           MOVE ZEROS TO ST-REM.
           PERFORM UNTIL ST-REM = "10"
             READ REMESSA AT END MOVE "10" TO ST-REM
               NOT AT END
                MOVE REG-REMESSA(1: 2) TO TIPO-W
                IF TIPO-W <> 1 CONTINUE
                ELSE
                 MOVE REG-REMESSA(3: 498) TO REM-TIPO1
                 ADD 1 TO SEQ-WK
                 MOVE NOME-CLIENTE-T1        TO NOME-WK
                 MOVE ENDERECO-CLIENTE-T1    TO ENDERECO-WK
                 MOVE CIDADE-CLIENTE-T1      TO CIDADE-WK
                 MOVE UF-CLIENTE-T1          TO UF-WK
                 MOVE CEP-CLIENTE-T1         TO CEP-WK
                 MOVE SEU-NUMERO-T1          TO DOCTO-WK
                 MOVE VALOR-TITULO-T1(4: 8)  TO VALOR-WK(1: 8)
                 MOVE VALOR-TITULO-T1(12: 2) TO VALOR-WK(9: 2)
                 WRITE REG-WORK
                 END-WRITE
                END-IF
             END-READ
           END-PERFORM.

           COPY "COND-IMP".
           OPEN OUTPUT RELAT.
           CLOSE WORK.  OPEN INPUT WORK.
           MOVE ZEROS TO LIN.
           PERFORM CABECALHO.
           MOVE SPACES TO NOME-WK.
           START WORK KEY IS NOT < NOME-WK INVALID KEY
                 MOVE "10" TO ST-WORK.
           PERFORM UNTIL ST-WORK = "10"
             READ WORK NEXT RECORD END MOVE "10" TO ST-WORK
               NOT AT END
                 MOVE NOME-WK           TO NOME-REL
                 MOVE ENDERECO-WK       TO ENDERECO-REL
                 MOVE CIDADE-WK         TO CIDADE-REL
                 MOVE UF-WK             TO UF-REL
                 MOVE CEP-WK            TO CEP-REL
                 MOVE DOCTO-WK          TO DOCTO-REL
                 MOVE VALOR-WK          TO VALOR-REL
                 WRITE REG-RELAT FROM LINDET
                 ADD 1 TO LIN
                 IF LIN > 56 PERFORM CABECALHO
                 END-IF
             END-READ
           END-PERFORM.
           MOVE VALOR-TOTAL             TO VALOR-TOTAL-REL.
           MOVE QTDE-TIT                TO QTDE-TIT-TOTAL-REL.
           WRITE REG-RELAT FROM LINDET1 AFTER 3.
           MOVE SPACES TO REG-RELAT.
           WRITE REG-RELAT AFTER PAGE.
           CLOSE RELAT REMESSA WORK.
           DELETE FILE WORK.
           COPY "DESC-IMP".
      *---------------------------------------------------
       LER-PORTADOR SECTION.
           MOVE GS-PORTADOR TO PORTADOR.
           READ CAD018 INVALID KEY MOVE "*******"  TO NOME-PORT.
           MOVE NOME-PORT TO GS-DESCR-PORTADOR.
       POPUP-PORTADOR SECTION.
           CALL "CAP018T" USING PARAMETROS-W STRING-1
           CANCEL "CAP018T"
           MOVE STRING-1(1: 30) TO GS-DESCR-PORTADOR
           MOVE STRING-1(33: 4) TO GS-PORTADOR.
      *----------------------------------------------------------
       CABECALHO-TIPO0 SECTION.
           MOVE SPACES TO GS-LINDET.
           MOVE "I"                 TO GS-LINDET(1: 2)
           MOVE "LIT.REM"           TO GS-LINDET(3: 8)
           MOVE "CS"                TO GS-LINDET(11: 3)
           MOVE "LIT-SERVICO"       TO GS-LINDET(14: 16)
           MOVE "BRANCO"            TO GS-LINDET(30: 08)
           MOVE "AGENC"             TO GS-LINDET(38: 05)
           MOVE "V"                 TO GS-LINDET(43: 2)
           MOVE "CONTA"             TO GS-LINDET(45: 09)
           MOVE "D"                 TO GS-LINDET(54: 02)
           MOVE "NR.CON"            TO GS-LINDET(56: 07)
           MOVE "NOME-EMPRESA"      TO GS-LINDET(63: 31)
           MOVE "NOME-BANCO"        TO GS-LINDET(94: 19)
           MOVE "DDMMAA"            TO GS-LINDET(113: 7)
           MOVE "SEQUEN"            TO GS-LINDET(120: 8)
           MOVE "BRANCO"            TO GS-LINDET(128: 288)
           MOVE "SEQUEN"            TO GS-LINDET(416: 06)
           MOVE "INSERE-LIST" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.
       LINDET-TIPO0 SECTION.
           MOVE SPACES TO GS-LINDET.
           MOVE REG-REMESSA(3: 498) TO REM-TIPO0.
      *    MOVE IDENT-ARQ-T0        TO GS-LINDET(1: 2)
      *    MOVE LITERAL-REMESSA-T0  TO GS-LINDET(3: 8)
      *    MOVE CODIGO-SERVICO-T0   TO GS-LINDET(11: 3)
      *    MOVE LITERAL-SERVICO-T0  TO GS-LINDET(14: 16)
      *    MOVE BRANCO-T0           TO GS-LINDET(30: 08)
      *    MOVE AGENCIA-T0          TO GS-LINDET(38: 05)
      *    MOVE VER-AGENCIA-T0      TO GS-LINDET(43: 2)
      *    MOVE CONTA-T0            TO GS-LINDET(45: 09)
      *    MOVE VERIF-EMP-T0        TO GS-LINDET(54: 02)
      *    MOVE NR-CONVENENTE-T0    TO GS-LINDET(56: 07)
      *    MOVE NOME-EMP-T0         TO GS-LINDET(63: 31)
      *    MOVE NOME-BANCO-T0       TO GS-LINDET(94: 19)
      *    MOVE DDMMAA-T0           TO GS-LINDET(113: 7)
      *    MOVE SEQUENCIAL-T0       TO GS-LINDET(120: 8)
      *    MOVE BRANCO1-T0          TO GS-LINDET(128: 288)
      *    MOVE REG-REMESSA(395: 6) TO GS-LINDET(416: 6)
           MOVE "INSERE-LIST" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.

       CABECALHO-TIPO1 SECTION.
           MOVE SPACES TO GS-LINDET.
           MOVE "INSERE-LIST" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.
           MOVE "CONVEN"            TO GS-LINDET(1:7)
           MOVE "CT"                TO GS-LINDET(8:3)
           MOVE "VAR"               TO GS-LINDET(11:4)
           MOVE "SEU-NR"            TO GS-LINDET(15:11)
           MOVE "NOSSO-NR"          TO GS-LINDET(26:20)
           MOVE "CONTROLE"          TO GS-LINDET(46:25)
           MOVE "SIGLA"             TO GS-LINDET(71:6)
           MOVE "DT-EMISS"          TO GS-LINDET(77:9)
           MOVE "DT-VECTO"          TO GS-LINDET(86:9)
           MOVE "   VLR-TITULO"     TO GS-LINDET(108:14)
           MOVE "C-MOE"             TO GS-LINDET(122:6)
           MOVE "    QTD-MOEDA"     TO GS-LINDET(128:14)
           MOVE "A"                 TO GS-LINDEt(142:2)
           MOVE "      VLR-JRS"     TO GS-LINDET(144:14)
           MOVE "DT-LIMIT"          TO GS-LINDET(158:9)
           MOVE "     VLR-DESC"     TO GS-LINDET(167:14)
           MOVE "     VLR-ABAT"     TO GS-LINDET(183:14)
           MOVE "DP"                TO GS-LINDET(197:3)
           MOVE "MENSAGEM"          TO GS-LINDET(200:41)
           MOVE "CONV7POS"          TO GS-LINDET(241:10)
           MOVE "M"                 TO GS-LINDET(251:2)
           MOVE "DT-MULTA"          TO GS-LINDET(253:9)
           MOVE "    VLR-MULTA"     TO GS-LINDET(262:14)
           MOVE "FILLER"            TO GS-LINDET(278:10)
           MOVE "TA"                TO GS-LINDET(288:3)
           MOVE "INSC.AVAL"         TO GS-LINDET(291:15)
           MOVE "NOME AVALISTA"     TO GS-LINDET(306:38)
           MOVE "I"                 TO GS-LINDET(344:2)
           MOVE "TC"                TO GS-LINDET(346:3)
           MOVE "INSC.CLIENTE"      TO GS-LINDET(349:15)
           MOVE "NOME CLIENTE"      TO GS-LINDET(364:38)
           MOVE "ENDERECO"          TO GS-LINDET(402:38)
           MOVE "CEP"               TO GS-LINDET(440:9)
           MOVE "CIDADE"            TO GS-LINDET(449:16)
           MOVE "UF"                TO GS-LINDET(465:3)

           MOVE "INSERE-LIST" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.

       LINDET-TIPO1 SECTION.
           MOVE SPACES TO GS-LINDET.
           MOVE REG-REMESSA(3: 498)    TO REM-TIPO1.
           MOVE CONVENIO-T1            TO GS-LINDET(1:7)
           MOVE CARTEIRA-T1            TO GS-LINDET(8:3)
           MOVE VARIACAO-T1            TO GS-LINDET(11:4)
           MOVE SEU-NUMERO-T1          TO GS-LINDET(15:11)
           MOVE NOSSO-NUMERO-T1        TO GS-LINDET(26:20)
           MOVE CONTROLE-T1            TO GS-LINDET(46:25)
           MOVE SIGLA-ESPECIE-T1       TO GS-LINDET(71:6)
           MOVE DATA-EMISSAO-T1        TO GS-LINDET(77:9)
           MOVE DATA-VENCTO-T1         TO GS-LINDET(86:9)
           MOVE VALOR-TITULO-T1        TO GS-LINDET(108:14)
           MOVE CODIGO-MOEDA-T1        TO GS-LINDET(122:6)
           MOVE QUANTIDADE-MOEDA-T1    TO GS-LINDET(128:14)
           MOVE ACEITE-T1              TO GS-LINDEt(142:2)
           MOVE VALOR-JUROS-T1         TO GS-LINDET(144:14)
           MOVE DATA-LIMITE-DESC-T1    TO GS-LINDET(158:9)
           MOVE VALOR-DESCONTO-T1      TO GS-LINDET(167:14)
           MOVE VALOR-ABATIMENTO-T1    TO GS-LINDET(183:14)
           MOVE QUANTIDADE-DIA-PRO-T1  TO GS-LINDET(197:3)
           MOVE MENSAGEM-T1            TO GS-LINDET(200:41)
           MOVE CONVENIO7-POS-T1       TO GS-LINDET(241:10)
           MOVE CODIGO-MULTA-T1        TO GS-LINDET(251:2)
           MOVE DATA-MULTA-T1          TO GS-LINDET(253:9)
           MOVE VALOR-MULTA-T1         TO GS-LINDET(262:14)
           MOVE FILLER-T1              TO GS-LINDET(278:10)
           MOVE TIPO-INSCRICAO-AVAL-T1 TO GS-LINDET(288:3)
           MOVE INSCRICAO-AVALISTA-T1  TO GS-LINDET(291:15)
           MOVE NOME-AVALISTA-T1       TO GS-LINDET(306:38)
           MOVE PENDENTE-IMPRESSAO-T1  TO GS-LINDET(344:2)
           MOVE TIPO-INSCRICAO-CLI-T1  TO GS-LINDET(346:3)
           MOVE INSCRICAO-CLIENTE-T1   TO GS-LINDET(349:15)
           MOVE NOME-CLIENTE-T1        TO GS-LINDET(364:38)
           MOVE ENDERECO-CLIENTE-T1    TO GS-LINDET(402:38)
           MOVE CEP-CLIENTE-T1         TO GS-LINDET(440:9)
           MOVE CIDADE-CLIENTE-T1      TO GS-LINDET(449:16)
           MOVE UF-CLIENTE-T1          TO GS-LINDET(465:3)

           MOVE "INSERE-LIST" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.
       CABECALHO-TIPO9 SECTION.
           MOVE SPACES TO GS-LINDET.
           MOVE "INSERE-LIST" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.
           MOVE "BRANCOS"     TO GS-LINDET(01: 394)
           MOVE "SEQUEN"      TO GS-LINDET(395: 6)
           MOVE "INSERE-LIST" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.
       LINDET-TIPO9 SECTION.
           MOVE SPACES              TO GS-LINDET.
           MOVE SPACES              TO GS-LINDET(1: 394)
           MOVE SEQ-W               TO GS-LINDET(395: 6).
           MOVE "INSERE-LIST" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.
      *---------------------------------------------------
       CARREGA-MENSAGEM-ERRO SECTION.
           PERFORM LOAD-SCREENSET.
           MOVE "EXIBE-ERRO" TO DS-PROCEDURE
           PERFORM CALL-DIALOG-SYSTEM.
           MOVE 1 TO GS-EXIT-FLG.
           MOVE 1 TO ERRO-W.
       CLEAR-FLAGS SECTION.
           INITIALIZE GS-FLAG-GROUP.

       SET-UP-FOR-REFRESH-SCREEN SECTION.
           MOVE "REFRESH-DATA" TO DS-PROCEDURE.

       LOAD-SCREENSET SECTION.
           MOVE DS-PUSH-SET TO DS-CONTROL
           MOVE "CRP9108" TO DS-SET-NAME
           PERFORM CALL-DIALOG-SYSTEM.

       exibir-mensagem section.
           move    spaces to resp-msg.
           call    "MENSAGEM" using tipo-msg resp-msg mensagem
           cancel  "MENSAGEM".
           move 1 to gs-flag-critica
           move spaces to mensagem.

       CALL-DIALOG-SYSTEM SECTION.
           CALL "DSRUN" USING DS-CONTROL-BLOCK, GS-DATA-BLOCK.
           IF NOT DS-NO-ERROR
              MOVE DS-ERROR-CODE TO DISPLAY-ERROR-NO
              DISPLAY "DS ERROR NO:  " DISPLAY-ERROR-NO
             GO FINALIZAR-PROGRAMA
           END-IF.
       FINALIZAR-PROGRAMA SECTION.
           open i-o logacess

           move function current-date to ws-data-sys

           move usuario-w           to logacess-usuario
           move ws-data-cpu         to logacess-data
           accept ws-hora-sys from time
           move ws-hora-sys         to logacess-horas
           move 1                   to logacess-sequencia
           move "CRP9108"           to logacess-programa
           move "FECHADO"           to logacess-status
           move "10" to fs-logacess
           perform until fs-logacess = "00"
                write reg-logacess invalid key
                    add 1 to logacess-sequencia
                not invalid key
                    move "00" to fs-logacess
                end-write
           end-perform

           close logacess

           CLOSE CRD020 SEQBRAS CGD010 CGD011 CGD014 CAD010 CAD018
                 CAD002 RETPORT.
           MOVE DS-QUIT-SET TO DS-CONTROL.
           PERFORM CALL-DIALOG-SYSTEM.
           EXIT PROGRAM.

